<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Data Pengumpulan â€¢ 01SIFP008</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
:root{
  --primary:#2563eb;
  --bg:#f8fafc;
  --card:#ffffff;
  --text:#0f172a;
}
body{
  background:var(--bg);
  font-family:'Segoe UI',sans-serif;
  color:var(--text);
}

/* ===== NAVBAR ===== */
.navbar-custom{
  position:sticky;
  top:0;
  z-index:1000;
  background:var(--card);
  border-bottom:1px solid #e5e7eb;
}
.navbar-wrap{
  max-width:1200px;
  margin:auto;
  padding:14px 20px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.brand{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:700;
}
.brand-icon{
  width:36px;height:36px;
  background:linear-gradient(135deg,#2563eb,#1e40af);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:10px;
}

/* ===== CARD ===== */
.card{
  background:var(--card);
  border:none;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.06)
}
.table th{
  background:#f1f5f9;
  font-size:14px
}
.table td{font-size:14px}
.task-card{
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:16px;
  margin-bottom:14px;
  background:var(--card)
}
</style>
</head>

<body>

<!-- ===== NAVBAR ===== -->
<nav class="navbar-custom">
  <div class="navbar-wrap">
    <div class="brand">
      <div class="brand-icon">ðŸ“Š</div>
      <span class="d-none d-md-inline">Data Pengumpulan â€¢ 01SIFP008</span>
    </div>
    <a href="index.html" class="btn btn-outline-primary btn-sm rounded-pill">
      <i class="bi bi-arrow-left"></i> Home
    </a>
  </div>
</nav>

<!-- ===== CONTENT ===== -->
<section class="container py-5">
<div class="card p-4">

  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
    <h4 class="fw-bold mb-0">Daftar Pengumpulan Tugas</h4>
    <div class="d-flex gap-2 flex-wrap">
      <button onclick="filterData('all')" class="btn btn-outline-primary btn-sm rounded-pill">Semua</button>
      <button onclick="filterData('done')" class="btn btn-outline-success btn-sm rounded-pill">Sudah</button>
      <button onclick="filterData('undone')" class="btn btn-outline-secondary btn-sm rounded-pill">Belum</button>
    </div>
  </div>

  <div class="progress mb-3" style="height:10px">
    <div id="progressBar" class="progress-bar bg-primary"></div>
  </div>

  <input type="text" id="searchInput"
    class="form-control rounded-pill mb-4"
    placeholder="Cari Nama atau NIM...">

  <!-- DESKTOP -->
  <div class="table-responsive d-none d-md-block">
    <table class="table align-middle text-center">
      <thead>
        <tr>
          <th>Absen</th>
          <th>NIM</th>
          <th>Nama</th>
          <th>Status</th>
          <th>Link</th>
          <th>PDF</th>
        </tr>
      </thead>
      <tbody id="tableData"></tbody>
    </table>
  </div>

  <!-- MOBILE -->
  <div class="d-md-none" id="cardData"></div>

</div>
</section>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
const sheetURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2IL61rnKBO29PUjq6sfLkE0jXJ0LRP0f2mnNTvjlwevA2p0WWuVAVvVgvL4DT12FLGEi_hlrPtEpO/pub?gid=0&single=true&output=csv";

let dataRows=[];

fetch(sheetURL)
.then(r=>r.text())
.then(t=>{
  dataRows=t.split("\n")
    .slice(1)
    .filter(r=>r.trim()!=="")
    .map(r=>r.split(",").map(x=>x.trim()));
  render(dataRows);
});

function render(rows){
  let table="", cards="", done=0;

  rows.forEach((r,i)=>{
    const status = r[2] || r[3];
    if(status) done++;

    /* DESKTOP */
    table+=`
    <tr>
      <td>${i+1}</td>
      <td>${r[0]}</td>
      <td>${r[1]}</td>
      <td>${status
        ?'<span class="badge bg-success">Sudah</span>'
        :'<span class="badge bg-secondary">Belum</span>'}
      </td>
      <td>${r[2]
        ?`<a href="${r[2]}" target="_blank" class="btn btn-sm btn-primary rounded-pill">Link</a>`
        :"-"}
      </td>
      <td>${r[3]
        ?`<a href="${r[3]}" target="_blank" class="btn btn-sm btn-danger rounded-pill">PDF</a>`
        :"-"}
      </td>
    </tr>`;

    /* MOBILE */
    cards+=`
    <div class="task-card">
      <div class="fw-semibold">#${i+1} ${r[1]}</div>
      <div class="text-muted small mb-2">${r[0]}</div>

      ${status
        ?'<span class="badge bg-success mb-2">Sudah Mengumpulkan</span>'
        :'<span class="badge bg-warning text-dark mb-2">Belum Mengumpulkan</span>'}

      <div class="d-flex gap-2 mt-3">
        ${r[2]
          ?`<a href="${r[2]}" target="_blank"
              class="btn btn-sm btn-primary rounded-pill w-50">
              <i class="bi bi-link-45deg"></i> Link
            </a>`
          :`<button class="btn btn-sm btn-outline-secondary rounded-pill w-50" disabled>Link</button>`
        }

        ${r[3]
          ?`<a href="${r[3]}" target="_blank"
              class="btn btn-sm btn-danger rounded-pill w-50">
              <i class="bi bi-file-earmark-pdf"></i> PDF
            </a>`
          :`<button class="btn btn-sm btn-outline-secondary rounded-pill w-50" disabled>PDF</button>`
        }
      </div>
    </div>`;
  });

  tableData.innerHTML = table;
  cardData.innerHTML  = cards;
  progressBar.style.width = ((done/rows.length)*100)+"%";
  progressBar.innerText   = done+" / "+rows.length;
}

function filterData(type){
  let rows=dataRows;
  if(type==='done') rows=dataRows.filter(r=>r[2]||r[3]);
  if(type==='undone') rows=dataRows.filter(r=>!(r[2]||r[3]));
  render(rows);
}

searchInput.addEventListener("input",()=>{
  const k=searchInput.value.toLowerCase();
  render(dataRows.filter(r=>
    r[0].toLowerCase().includes(k) ||
    r[1].toLowerCase().includes(k)
  ));
});
</script>

</body>
</html>

